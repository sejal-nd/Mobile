
skip_docs # skip autogenerating the README.md, we are manually writing it

default_platform(:ios)
  platform :ios do
    desc "Upload a pre-built IPA to the App Store and tag release"
    lane :uploadBuild do |options|
      deliver(
        api_key_path: options[:api_key_path],
        app_identifier: options[:bundle_id],
        ipa: options[:ipa_path],
        metadata_path: "./metadata",
        team_id: "YU7Y757VB5",
        submit_for_review: false,
        skip_screenshots: true,
        skip_app_version_update: true,
        ignore_language_directory_validation: true,
        run_precheck_before_submit: false,
        precheck_include_in_app_purchases: false,
        force: true
      )

      version = get_version_number(
        target: "EUMobile"
      )

      # Tags git release commit: ex: 5.10.0
      add_git_tag(
        tag: version,
        includes_lane: false
      )
    end

    desc "Upload a pre-built IPA to App Center and distribute"
    lane :uploadAppCenter do |options|
      appcenter_upload(
        api_token: options[:app_center_api_token],
        owner_name: "Exelon-Digital-Projects",
        owner_type: "organization",
        app_name: options[:app_name],
        file: options[:file_path],
        release_notes: options[:release_notes],
        destinations: options[:destinations]
      )
    end
  end
