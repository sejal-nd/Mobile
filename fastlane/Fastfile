# This file contains the fastlane.tools configuration
# You can find the documentation at https://docs.fastlane.tools
#
# For a list of all available actions, check out
#
#     https://docs.fastlane.tools/actions
#
# For a list of all available plugins, check out
#
#     https://docs.fastlane.tools/plugins/available-plugins
#

# Uncomment the line if you want fastlane to automatically update itself
# update_fastlane

skip_docs # skip autogenerating the README.md, we are manually writing it

default_platform(:ios)
  desc "Upload a pre-built IPA to the App Store"

  platform :ios do
    lane :uploadBuild do |options|
      update_fastlane

      deliver(
        api_key_path: options[:api_key_path],
        app_identifier: options[:bundle_id],
        ipa: options[:ipa_path],
        team_id: "YU7Y757VB5",
        submit_for_review: false,
        skip_screenshots: true,
        skip_metadata: true,
        skip_app_version_update: true,
        ignore_language_directory_validation: true,
        run_precheck_before_submit: false,
        precheck_include_in_app_purchases: false,
        force: true
      )

      version = get_version_number(
        target: "EUMobile"
      )

      add_git_tag(
        tag: version,
        includes_lane: false
      )
    end
  end
